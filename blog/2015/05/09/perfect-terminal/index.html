<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Perfect Terminal - Mandus Momberg&#8217;s Blog</title>
  <meta name="author" content="Mandus Momberg">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.mandusmomberg.com/blog/2015/05/09/perfect-terminal">
  <link href="/favicon.ico" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Mandus Momberg's Blog" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="http://blog.mandusmomberg.com/blog/2015/05/09/perfect-terminal">
  <meta property="og:title" content="Perfect Terminal - Mandus Momberg's Blog">
  

  <script src="/javascripts/libs/jquery/jquery-2.0.3.min.js"></script>

<link href="/assets/bootstrap/dist/css/bootstrap.min_flatly.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap_flatly.css" rel="stylesheet" type="text/css">


  
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

  
   <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-57224096-2', 'auto');
    ga('send', 'pageview');

  </script>



  <script src="//static.getclicky.com/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(100796274); }catch(e){}</script>
<noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100796274ns.gif" /></p></noscript>
</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Mandus Momberg&#8217;s Blog</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="search navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="q" value="site:blog.mandusmomberg.com">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="Mandus Momberg's Blog" />
    <meta itemprop="description" content="This blog is all about BigData, Linux, Windows and the Internet of Things. If it is cool, it belongs here." />
    <meta itemprop="url" content="http://blog.mandusmomberg.com" />
    <article class="hentry" role="article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2015-05-09T12:28:57+02:00"  data-updated="true" itemprop="datePublished dateCreated">09 May 2015</time>
        
      </p>
    
    
    <h1 class="entry-title" itemprop="name headline">
        Perfect Terminal
        
    </h1>
    
  </header>


<div class="entry-content clearfix" itemprop="articleBody description"><p>I spend an exuberant amount of time working inside terminals and using ssh to manage remote servers. They range from the default terminal interface shipped with Linux, to the more outrageous OSX Based iTerm2. It&rsquo;s safe to say that because of this, I have spent much of my time customizing the way my terminals react and display information as well as store my SSH keys for easy authentication. In this BLOG post I will discuss the terminals I use and the different settings I invoke to make my time spent in them, more pleasurable. I&rsquo;ll also take a look at how to make SSH keys available across terminal sessions.</p>

<!--more-->


<h3>An Example</h3>

<p>To start off with, this is an example of my terminal in iTerm2 on OSX
<img src="/images/blog_images/shell_preview.png"></p>

<h3>Choices, Choices.</h3>

<p>As you probably know, there is a very large array of terminal emulators available out there. They are all different across Operating Systems, but most of them have the same basic functionality. <br/>
For me the core requirements are&hellip;</p>

<ul>
<li>Split Screen</li>
<li>Auto Scroll</li>
<li>Infinite scroll-back</li>
<li>Broadcasting</li>
</ul>


<p>With the above core requirements in mind, my terminals of choice, per OS, is&hellip;</p>

<ul>
<li>Windows : <a href="http://www.fosshub.com/ConEmu.html">ConEmu</a></li>
<li>Linux : <a href="http://gnometerminator.blogspot.com/p/introduction.html">Terminator</a></li>
<li>OSX : <a href="https://www.iterm2.com/">iTerm2</a></li>
</ul>


<h3>I feel pretty, O so Pretty</h3>

<p>Most of the terminals nowadays come with the ability to theme and set the color schemes of your shell. A lot of my friends opt for the green-on-black combination. This hurts my eyes more than anything else after a few hours and although it looks cool and all Matrix-like, I&rsquo;ve grown to not like it that much. Instead I prefer a soft white on a black background. That, together with some color coding to differentiate between different elements like folders and symlinks is what I have settled on.</p>

<p>To implement this is pretty straight forward and only requires a little tinkering in your Bash Profile settings. Specifically, you need to set the PS1 and PS2 Environment Variables that dictates your Default and Continuous Interactive Prompt. I&rsquo;m not going to go into this in too much detail, but if you want to read some more about it, you can read this awesome post at <a href="http://www.thegeekstuff.com/2008/09/bash-shell-take-control-of-ps1-ps2-ps3-ps4-and-prompt_command/">TheGeekStuff</a></p>

<p>To have the changes persistent across multiple terminals you make the changes in <code>~/.bashrc</code></p>

<figure class='code'><figcaption><span>~/.bashrc</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">export </span><span class="nv">CLICOLOR</span><span class="o">=</span>1
</span><span class='line'><span class="nb">export </span><span class="nv">LSCOLORS</span><span class="o">=</span>GxFxCxDxBxegedabagaced
</span><span class='line'>
</span><span class='line'><span class="k">function</span> prompt <span class="o">{</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">BLACK</span><span class="o">=</span><span class="s2">&quot;\[\033[0;30m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">BLACKBOLD</span><span class="o">=</span><span class="s2">&quot;\[\033[1;30m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">RED</span><span class="o">=</span><span class="s2">&quot;\[\033[0;31m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">REDBOLD</span><span class="o">=</span><span class="s2">&quot;\[\033[1;31m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">GREEN</span><span class="o">=</span><span class="s2">&quot;\[\033[0;32m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">GREENBOLD</span><span class="o">=</span><span class="s2">&quot;\[\033[1;32m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">YELLOW</span><span class="o">=</span><span class="s2">&quot;\[\033[0;33m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">YELLOWBOLD</span><span class="o">=</span><span class="s2">&quot;\[\033[1;33m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">BLUE</span><span class="o">=</span><span class="s2">&quot;\[\033[0;34m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">BLUEBOLD</span><span class="o">=</span><span class="s2">&quot;\[\033[1;34m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">PURPLE</span><span class="o">=</span><span class="s2">&quot;\[\033[0;35m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">PURPLEBOLD</span><span class="o">=</span><span class="s2">&quot;\[\033[1;35m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">CYAN</span><span class="o">=</span><span class="s2">&quot;\[\033[0;36m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">CYANBOLD</span><span class="o">=</span><span class="s2">&quot;\[\033[1;36m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">WHITE</span><span class="o">=</span><span class="s2">&quot;\[\033[0;37m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">WHITEBOLD</span><span class="o">=</span><span class="s2">&quot;\[\033[1;37m\]&quot;</span>
</span><span class='line'>  <span class="nb">local </span><span class="nv">RESETCOLOR</span><span class="o">=</span><span class="s2">&quot;\[\e[00m\]&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nb">export </span><span class="nv">PS1</span><span class="o">=</span><span class="s2">&quot;$RED\u$PURPLE @ $GREEN\w:  $RESETCOLOR&quot;</span>
</span><span class='line'>  <span class="nb">export </span><span class="nv">PS2</span><span class="o">=</span><span class="s2">&quot;| → $RESETCOLOR&quot;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>
</span><span class='line'>prompt
</span></code></pre></td></tr></table></div></figure>


<h3>My SSH-Swiss Army knife</h3>

<p>Now that my terminal reads easily and I can work without getting a headache every two hours, I needed to look at the way I was logging into remote servers. Usually this is done using SSH and my preferred method of authenticating is by using SSH Keys. If you want more details on how to set up key-less SSH you can read this article at <a href="http://www.linuxproblem.org/art_9.html">LinuxProblems</a></p>

<p>It&rsquo;s quite simple to start the ssh-agent and to add a key to it for easy authentication.</p>

<figure class='code'><figcaption><span>Starting SSH-Agent and Adding Keys</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">eval</span> <span class="sb">`</span>ssh-agent<span class="sb">`</span>
</span><span class='line'>ssh-add /path/to/key
</span></code></pre></td></tr></table></div></figure>


<p>Although this is really quite easy, it means that I need to run this every time I open a new terminal. Fair enough, I can add it to my <code>~/.bashrc</code> file and it will automatically do this every time a new terminal is opened, but this will leave me with a huge amount of ssh-agent&rsquo;s running in the background and this isn&rsquo;t something I am happy with.</p>

<p>To fix this, I started working on a solution which will check for a SSH-Agent and then re-use it. A few lines in I figured there should definitely be something like this available in the FOSS community. So after a bit of searching I found this project on Github. <a href="https://github.com/wwalker/ssh-find-agent">ssh-find-agent</a></p>

<p>It works great and it allows me to simplify my script to a huge extent. The first step is to clone this project to somewhere on my machine. I prefer it to be in my home folder in a hidden folder. <code>~/.ssh-find-agent</code></p>

<p>Once this has been cloned, I can then simply add the following to my <code>~/.bashrc</code></p>

<figure class='code'><figcaption><span>~/.bashrc</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="c">#Set The SSH-Agent Environment</span>
</span><span class='line'>. ~/.ssh-find-agent/ssh-find-agent.sh
</span><span class='line'>ssh-find-agent -a
</span><span class='line'><span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;$SSH_AUTH_SOCK&quot;</span> <span class="o">]</span>
</span><span class='line'><span class="k">then</span>
</span><span class='line'>   <span class="nb">eval</span> <span class="k">$(</span>ssh-agent<span class="k">)</span> &gt; /dev/null
</span><span class='line'>   ssh-add -l &gt;/dev/null <span class="o">||</span> <span class="nb">alias </span><span class="nv">ssh</span><span class="o">=</span><span class="s1">&#39;ssh-add -l &gt;/dev/null || ssh-add &amp;&amp; unalias ssh; ssh&#39;</span>
</span><span class='line'>   ssh-add /path/to/key <span class="p">&amp;</span>&gt; /dev/null
</span><span class='line'><span class="k">fi</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, every time I launch a new terminal it will look for a running SSH-Agent and add my keys to it, instead launching a new SSH-Agent process. If there is no running process, it will start one.</p>

<h3>&amp;> /dev/null</h3>

<p>There you go, everything you need to know about having a fun and easy terminal session. How to easily log into a server using key-less SSH.</p>
</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="glyphicon glyphicon-user"></span> <span class="byline author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person">Posted by <span class="fn" itemprop="name">Mandus Momberg</span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2015-05-09T12:28:57+02:00"  data-updated="true" itemprop="datePublished dateCreated">09 May 2015</time>
          


        </p>
        
          <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://blog.mandusmomberg.com/blog/2015/05/09/perfect-terminal/" data-via="" data-counturl="http://blog.mandusmomberg.com/blog/2015/05/09/perfect-terminal/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/blog/2014/12/15/tis-the-season-of-wifi/" title="Previous Post: Tis the season of Wifi">&laquo; Tis the season of Wifi</a></li>
            
            
            <li class="next"><a href="/blog/2015/05/10/open-source-me/" title="Next Post: Open Source Me">Open Source Me &raquo;</a></li>
            
          </ul>
        
      </footer>
    </article>
    
      <section>
        <h2>Comments</h2>
        <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </section>
    
  </div>

  
  <aside class="sidebar col-md-3">
    
      <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2015/05/10/open-source-me/">Open Source Me</a>
    
    <a class="list-group-item active" href="/blog/2015/05/09/perfect-terminal/">Perfect Terminal</a>
    
    <a class="list-group-item " href="/blog/2014/12/15/tis-the-season-of-wifi/">Tis the Season of Wifi</a>
    
    <a class="list-group-item " href="/blog/2014/12/01/o-what-a-beautiful-bashing/">O! What a Beautiful BASHing!</a>
    
    <a class="list-group-item " href="/blog/2014/11/30/this-is-a-new-start/">This Is a New Start! Welcome OctoPress!</a>
    
  </div>
</section>






    
  </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2015 - Mandus Momberg<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'mandusm';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.mandusmomberg.com/blog/2015/05/09/perfect-terminal/';
        var disqus_url = 'http://blog.mandusmomberg.com/blog/2015/05/09/perfect-terminal/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>




  </body>
</html>
